{"version":3,"sources":["recoil/atoms/mapAtoms.js","components/KakaoMap.js","components/RNListener.js","App.js","reportWebVitals.js","index.js"],"names":["mapAtoms","locationState","atom","key","default","latitude","longitude","keywordState","keyword","undefined","paginationState","page","axios","defaults","baseURL","headers","common","process","kakao","window","Container","styled","div","KaKaoMap","activeOverlay","location","useRecoilValue","keywordFromRN","pageState","useState","map","setCurrentMap","placeData","setPlaceData","get","markers","imageSize","maps","Size","useEffect","event","addListener","setMap","ReactNativeWebView","postMessage","JSON","stringify","type","message","remove","container","document","getElementById","options","center","LatLng","level","Map","console","log","searchPlaces","then","res","data","documents","length","mergeList","sortByDistance","sort","a","b","distance","placesSearchCB","status","removeMarker","catch","err","displayPlaces","services","Status","ZERO_RESULT","alert","ERROR","places","bounds","LatLngBounds","i","placePosition","y","x","addMarker","place_name","extend","setBounds","position","idx","title","imgOptions","spriteSize","spriteOrigin","Point","offset","markerImage","createMarkerImage","marker","Marker","image","content","customOverlay","CustomOverlay","push","markerSize","imageSrc","imageOptions","MarkerImage","id","RNListener","children","useRecoilState","setLocation","setKeyword","setPage","addEventListener","listener","removeEventListener","parse","Fragment","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.dff462e6.chunk.js","sourcesContent":["import {atom} from \"recoil\";\n\nconst locationState = atom({\n    key: 'locationState',\n    default: {\n        latitude: 37.56080754022743,\n        longitude: 126.92737579814681,\n    }\n})\n\nconst keywordState = atom({\n    key: 'keywordState',\n    default: {\n        keyword: undefined,\n    }\n})\n\nconst paginationState = atom({\n    key: 'paginationState',\n    default: {\n        page: 1,\n    }\n})\n\nexport const mapAtoms = {\n    locationState,\n    keywordState,\n    paginationState,\n}\n","import * as React from 'react';\nimport styled from \"styled-components\";\nimport {useEffect, useState} from \"react\";\nimport {useRecoilState, useRecoilValue} from \"recoil\";\nimport {mapAtoms} from \"../recoil/atoms/mapAtoms\";\nimport {get} from 'lodash';\nimport \"./styles/map.css\";\nimport axios from 'axios';\n\naxios.defaults.baseURL = 'https://dapi.kakao.com'\naxios.defaults.headers.common['Authorization'] = `KakaoAK ${process.env.REACT_APP_KAKAO_LOCAL_KEY}`;\naxios.defaults.headers.common['X-Requested-With'] = 'curl';\n\nconst {kakao} = window\n\nconst KaKaoMap = () => {\n    const location = useRecoilValue(mapAtoms.locationState);\n    const keywordFromRN = useRecoilValue(mapAtoms.keywordState);\n    const pageState = useRecoilValue(mapAtoms.paginationState);\n    const [map, setCurrentMap] = useState();\n    const [placeData, setPlaceData] = useState();\n\n    // const keyword = get(keywordFromRN, 'keyword');\n    const keyword = '맛집';\n    const latitude = get(location, 'latitude');\n    const longitude = get(location, 'longitude');\n    const page = get(pageState, 'page');\n    let markers = [];\n    let activeOverlay;\n    const defaultImageSrc = 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_number_blue.png', // 마커 이미지 url, 스프라이트 이미지를 씁니다\n          imageSize = new kakao.maps.Size(36, 37);  // 마커 이미지의 크기\n\n    useEffect(() => {\n        if (map) {\n            const clearOverlay = () => {\n                activeOverlay && activeOverlay.setMap(null);\n                if (window.ReactNativeWebView) {\n                    window.ReactNativeWebView.postMessage(\n                        JSON.stringify({\n                            type: 'selectedPlace',\n                            message: null,\n                        })\n                    )\n                }\n            }\n            kakao.maps.event.addListener(map, 'click', clearOverlay);\n\n            return () => {\n                kakao.maps.event.remove();\n            }\n        }\n    },[map, activeOverlay])\n\n    useEffect(() => {\n        let container = document.getElementById('map');\n        if (kakao) {\n            let options = {\n                center: new kakao.maps.LatLng(latitude, longitude),\n                level: 3,\n            }\n            setCurrentMap(new kakao.maps.Map(container, options));\n        }\n    }, [kakao])\n\n    useEffect(() => {\n        console.log(location)\n        console.log(latitude)\n        console.log(longitude);\n        console.log(keywordFromRN)\n        console.log(keyword)\n        console.log(page);\n        if (page === 1) {\n            setPlaceData([]);\n        }\n        if(keyword && map) {\n            searchPlaces()\n        }\n    },[keywordFromRN, location, map, page])\n\n    const searchPlaces = () => {\n        axios.get(`/v2/local/search/keyword.json?query=${keyword}&y=${latitude}&x=${longitude}&radius=20000&page=${page}`,\n        ).then((res) => {\n            if (res.data.documents.length > 0) {\n                const mergeList = [...placeData, ...res.data.documents];\n                setPlaceData(mergeList);\n                const sortByDistance = mergeList.sort(function(a, b) { // 오름차순\n                    return a.distance - b.distance;\n                });\n                placesSearchCB(sortByDistance, res.status)\n            } else {\n                removeMarker();\n                if (window.ReactNativeWebView) {\n                    window.ReactNativeWebView.postMessage(\n                        JSON.stringify({\n                            type: 'placeData',\n                            message: [],\n                        })\n                    )\n                }\n            }\n        }).catch(err => console.log(err))\n    }\n\n    const placesSearchCB = (data, status) => {\n        if (status === 200) {\n\n            // 정상적으로 검색이 완료됐으면\n            // 검색 목록과 마커를 표출합니다\n            if (window.ReactNativeWebView) {\n                window.ReactNativeWebView.postMessage(\n                    JSON.stringify({\n                        type: 'placeData',\n                        message: data\n                    })\n                )\n            }\n            displayPlaces(data);\n\n        } else if (status === kakao.maps.services.Status.ZERO_RESULT) {\n\n            alert('검색 결과가 존재하지 않습니다.');\n            return;\n\n        } else if (status === kakao.maps.services.Status.ERROR) {\n\n            alert('검색 결과 중 오류가 발생했습니다.');\n            return;\n\n        }\n    }\n\n    const displayPlaces = (places) => {\n\n        let bounds = new kakao.maps.LatLngBounds();\n\n        // 지도에 표시되고 있는 마커를 제거합니다\n        removeMarker();\n        for (let i = 0; i < places.length; i++) {\n\n            // 마커를 생성하고 지도에 표시합니다\n            let placePosition = new kakao.maps.LatLng(places[i].y, places[i].x);\n            let marker = addMarker(placePosition, i, places[i]?.place_name);\n\n            // 검색된 장소 위치를 기준으로 지도 범위를 재설정하기위해\n            // LatLngBounds 객체에 좌표를 추가합니다\n            bounds.extend(placePosition);\n        }\n\n        // 검색된 장소 위치를 기준으로 지도 범위를 재설정합니다\n        map.setBounds(bounds);\n    }\n\n// 마커를 생성하고 지도 위에 마커를 표시하는 함수입니다\n    const addMarker = (position, idx, title) => {\n        const imgOptions = {\n                spriteSize: new kakao.maps.Size(36, 691), // 스프라이트 이미지의 크기\n                spriteOrigin: new kakao.maps.Point(0, (idx * 46) + 10), // 스프라이트 이미지 중 사용할 영역의 좌상단 좌표\n                offset: new kakao.maps.Point(13, 37) // 마커 좌표에 일치시킬 이미지 내에서의 좌표\n            },\n            markerImage = createMarkerImage(imageSize, defaultImageSrc, imgOptions),\n            marker = new kakao.maps.Marker({\n                position: position, // 마커의 위치\n                image: markerImage,\n            });\n\n        marker.setMap(map); // 지도 위에 마커를 표출합니다\n        const content = `<div class =\"label\"><span class=\"left\"></span><span class=\"center\">${title}</span><span class=\"right\"></span></div>`;\n\n        const customOverlay = new kakao.maps.CustomOverlay({\n            position: position,\n            content: content\n        });\n\n        kakao.maps.event.addListener(marker, 'click', () => {\n            // 마커 위에 인포윈도우를 표시합니다\n            if (window.ReactNativeWebView) {\n                window.ReactNativeWebView.postMessage(\n                    JSON.stringify({\n                        type: 'selectedPlace',\n                        message: idx,\n                    })\n                )\n            }\n            activeOverlay && activeOverlay.setMap(null);\n            customOverlay.setMap(map);\n            activeOverlay = customOverlay;\n\n        });\n\n        markers.push(marker);  // 배열에 생성된 마커를 추가합니다\n\n        return marker;\n    }\n\n    // 지도 위에 표시되고 있는 마커를 모두 제거합니다\n    const removeMarker = () => {\n        for (let i = 0; i < markers.length; i++) {\n            markers[i].setMap(null);\n        }\n        markers = [];\n    }\n\n    const createMarkerImage = (markerSize, imageSrc, imageOptions) => {\n        const markerImage = new kakao.maps.MarkerImage(\n            imageSrc, // 스프라이트 마커 이미지 URL\n            markerSize, // 마커의 크기\n            imageOptions,\n        );\n\n        return markerImage;\n    }\n\n    return (\n        <Container id=\"map\">\n        </Container>\n    )\n}\n\nconst Container = styled.div`\n  width: 100vw;\n  height: 100vh;\n`;\n\nexport default KaKaoMap;\n","import React, {useEffect} from 'react';\nimport {useRecoilState} from \"recoil\";\nimport {mapAtoms} from \"../recoil/atoms/mapAtoms\";\n\nconst RNListener = ({children}) => {\n\n    const [location, setLocation] = useRecoilState(mapAtoms.locationState);\n    const [keyword, setKeyword] = useRecoilState(mapAtoms.keywordState);\n    const [page, setPage] = useRecoilState(mapAtoms.paginationState);\n    useEffect(() => {\n        if (window.ReactNativeWebView) {\n            // android\n            document.addEventListener(\"message\", listener);\n            // ios\n            window.addEventListener(\"message\", listener);\n        }\n        return () => {\n            document.removeEventListener(\"message\", listener);\n            window.removeEventListener(\"message\", listener);\n        }\n    }, [])\n\n    const listener = (event) => {\n        console.log(JSON.parse(event.data));\n        const {data, type} = JSON.parse(event.data);\n        if (type === \"Location\") {\n            setPage({page: 1});\n            setLocation(data);\n        }\n        if (type === \"Keyword\") {\n            console.log(data.keyword);\n            if (data.keyword === '') {\n                setKeyword({keyword: '맛집'});\n            } else {\n                setKeyword({keyword: `${data.keyword} 맛집`});\n            }\n        }\n        if (type === 'Page') {\n            setPage(data)\n        }\n    };\n\n    return (\n        <React.Fragment>\n            {children}\n        </React.Fragment>\n    )\n}\n\nexport default RNListener;\n","import React from 'react';\nimport KaKaoMap from \"./components/KakaoMap\";\nimport RNListener from \"./components/RNListener\";\nimport {\n    RecoilRoot\n} from \"recoil\";\n\nfunction App() {\n  return (\n    <RecoilRoot>\n        <RNListener>\n          <KaKaoMap />\n        </RNListener>\n    </RecoilRoot>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}